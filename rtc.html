<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <title>Audio Conferencing using RTCMultiConnection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="shortcut icon" href="/demos/logo.png">
  <link rel="stylesheet" href="/demos/stylesheet.css">
  <script src="/demos/menu.js"></script>
</head>
<body>
 

  <h1>
    語音廣播系統
    <p class="no-mobile">
      歡迎使用導覽通語音廣播系統
    </p>
  </h1>

  <section class="make-center">
    <!--input type="text" id="room-id" value="abcdef" autocorrect=off autocapitalize=off size=20-->
    <button id="btn-open-room">Open Room</button>
    <button id="btn-join-room">Join Room</button>
    

    <div id="room-urls" style="text-align: center;display: none;background: #F1EDED;margin: 15px -10px;border: 1px solid rgb(189, 189, 189);border-left: 0;border-right: 0;"></div>

    <div id="audios-container"></div>
  </section>

  <script src="https://rtcmulticonnection.herokuapp.com/dist/RTCMultiConnection.min.js"></script>
<script src="/node_modules/webrtc-adapter/out/adapter.js"></script>
<script src="https://rtcmulticonnection.herokuapp.com/socket.io/socket.io.js"></script>
<script>
  let location_url = new URL(location.href);
			//console.log(location_url.toString());
			let roomid_params = location_url.searchParams;
			//console.log(tourid_params.toString());
      let key = roomid_params.toString().substr(4);
      console.log(key)
// ......................................................
// ..................RTCMultiConnection Code.............
// ......................................................
    var connection = new RTCMultiConnection();
    connection.socketMessageEvent = 'audio-conference-demo';
// this line is VERY_important
connection.socketURL = 'https://rtcmulticonnection.herokuapp.com:443/';

// all below lines are optional; however recommended.

connection.session = {
    audio: true,
    video: false
};
connection.mediaConstraints = {
    audio: true,
    video: false
};

connection.sdpConstraints.mandatory = {
    OfferToReceiveAudio: true,
    OfferToReceiveVideo: false
};

connection.onstream = function(event) {
    document.body.appendChild( event.mediaElement );
};
var predefinedRoomId = key;

document.getElementById('btn-open-room').onclick = function() {
    this.disabled = true;
    connection.open( predefinedRoomId );
};

document.getElementById('btn-join-room').onclick = function() {
    this.disabled = true;
    connection.join( predefinedRoomId );
};
</script>
</body>
</html>