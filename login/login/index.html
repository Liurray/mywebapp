<!DOCTYPE html>
<html lang="en">

<head>
	<title>導覽通驗證頁面</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!--//////init firebase-->
	<script src="/firebase-app.js"></script>
    <script src="/firebase-analytics.js"></script>
    <script src="/firebase-database.js"></script>
	<script>
        //firebase init app
        var firebaseConfig = {
            apiKey: "AIzaSyBXd4P9GdCXeiWD5n-VZlpVMsDCFoOUDYM",
            authDomain: "forchartjs.firebaseapp.com",
            databaseURL: "https://forchartjs.firebaseio.com"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
    </script>



	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
	<!-- LIFF v1只能用到2021年4月 https://developers.line.biz/en/docs/liff/versioning-policy/ -->
	<!-- LIFF v2從2019年10月啟用 https://developers.line.biz/en/docs/liff/developing-liff-apps/#developing-a-liff-app -->
	<script src="https://static.line-scdn.net/liff/edge/versions/2.3.0/sdk.js"></script>
	<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/favicon.ico" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<!--===============================================================================================-->
</head>

<body>
	<!--主程式-->
	<script>
		var  userId = "";
		async function main() {
			await liff.init({
				liffId: '1655371574-rK5awXB5'
			})
			if (liff.isLoggedIn()) {
				getUserProfile()
			} else {
				liff.login()
			}
		}
		main()
		async function getUserProfile() {
			const profile = await liff.getProfile()
			document.getElementById("profile_img").src = profile.pictureUrl
			document.getElementById("username").append(profile.displayName)
			document.getElementById("UID").append(profile.userId)
			userId = profile.userId;
		}
		 
		firebase.database().ref('User/').on("value", function (snapshot) {
				console.log(userId);
					snapshot.forEach(function (item) {
						if(item.val().userID===userId){
							document.getElementById("login_result") ="驗證結果:成功 "
						}else{
							document.getElementById("login_result") ="驗證結果:失敗 此使用者未登錄在資料庫中"
						}
					})
		})
	</script>



	<div class="limiter">
		<div class="container-login100">
			<div class="wrap-login100 p-t-85 p-b-20">
				<form class="login100-form validate-form">
					<span class="login100-form-title p-b-70" id='username'>
						<!--使用者名稱顯示在這-->
					</span>
					<span class="login100-form-avatar">
						<img id="profile_img" alt="AVATAR">
						<!--使用者個人照片-->
					</span>



					<span class="login100-form-title p-b-900">
						<p id='login_result'>驗證結果:</p>
						<!--驗證結果顯示在這-->
						<p id='UID'></p>
					</span>




					</ul>
				</form>
			</div>
		</div>
	</div>


	<div id="dropDownSelect1"></div>

	<!--===============================================================================================-->
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/daterangepicker/moment.min.js"></script>
	<script src="vendor/daterangepicker/daterangepicker.js"></script>
	<!--===============================================================================================-->
	<script src="vendor/countdowntime/countdowntime.js"></script>
	<!--===============================================================================================-->
	<script src="js/main.js"></script>


</body>

</html>